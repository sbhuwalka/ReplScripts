1. [Introduction](#introduction)
2. [Prerequisite](#prerequisite)
3. [Script Location](#script-location)
4. [How To Use](#how-to-use)

Introduction
ReplicationAndAG scripts allows us to configure replication in AG(availability group) seamlessly.
We can use the script to setup the publication,distribution and subscription database in AG along with the configuring the sql instance as publisher, distributor and subscriber.
The script can hanlde different scenarios like n number of node participating in AG, AG in multisubnet environment.
The script contains both the parts to setup as well as remove replication in AG.
This script removes the hassle of executing multiple stored procs in different sql instances which are participating in AG to setup the replication in AG thus making the setup pretty simple.
The script can be also be used to cleanup replication in AG setup by removing the replication(dropping the publisher, distributor and subscriber) and AG.
In case while executng the commands generated by the script some portion of the setup is done and then the next step fails because of any error then also the cleanup part of the script can be used to remove everything which was done be the setup.

Prerequisite
-- All the prerequisite to setup AG is needed
-- All the sql server instances participating in an AG should have the same version of sql server.
-- The host computer must be a WFSC node. The instances of SQL Server that host availability replicas for a 
   given availability group should reside on separate nodes of the cluster.
-- Enable AG feature in sql config manager for the all the sql server instances participating in AG.
-- Start the sql server agent if not started.
-- SQL sever instances should be running under a domain service account.
-- If the sql server instances that are hosting the availability replicas of an AG run as different account,then
   the login of each account must be created in master on the other server instance and that login must be granted CONNECT permission.
-- Make 2 shared folders one for backups and other for replication and provide the path in backupSharePath and replDirPath folder.
-- Give sql service account control of the following registry location for all the nodes.
   HKLM\SOFTWARE\WOW6432Node\Microsoft\MSSQLServer\Client\ConnectTo
   HKLM\SOFTWARE\Microsoft\MSSQLServer\Client\ConnectTo
-- In case of AG in multisubnet environment MultiSubnetFailover property should be added and set to true in the log reader
   and distribution agent parameter.
-- Publication and subscription databases should be created beforehand.
-- While running the cleanup script update the primary replica values with the current primary replica.
   This is important in the scenario in case a failover has happened and the primary replica changes.
-- Currently AG is being created with some default parameters. In case some parameters needs to be modified,
   the script needs to be modified accordingly.

Script Location
In this folder
distag.sql is the script for setting the distributor and dstribution db in AG
pubag.sql is the script for setting the publisher and publication db in AG
subag.sql is the script for setting the subscriber and subscription db in AG

How To Use
  

